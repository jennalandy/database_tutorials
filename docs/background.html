<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Background | Using Databases</title>
  <meta name="description" content="2 Background | Using Databases" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Background | Using Databases" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="jennalandy/stat400_database_tutorials" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Background | Using Databases" />
  
  
  

<meta name="author" content="Nick Padilla and Jenna Landy in collaboration with Hunter Glanz and Rebecca Ottesen" />


<meta name="date" content="2020-05-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="machine-setup.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>2</b> Background</a><ul>
<li class="chapter" data-level="2.1" data-path="background.html"><a href="background.html#motivation"><i class="fa fa-check"></i><b>2.1</b> Motivation</a></li>
<li class="chapter" data-level="2.2" data-path="background.html"><a href="background.html#about-databases"><i class="fa fa-check"></i><b>2.2</b> About Databases</a><ul>
<li class="chapter" data-level="2.2.1" data-path="background.html"><a href="background.html#relational-model"><i class="fa fa-check"></i><b>2.2.1</b> Relational Model</a></li>
<li class="chapter" data-level="2.2.2" data-path="background.html"><a href="background.html#basic-introduction-to-sql"><i class="fa fa-check"></i><b>2.2.2</b> Basic Introduction to SQL</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="machine-setup.html"><a href="machine-setup.html"><i class="fa fa-check"></i><b>3</b> Machine Setup</a><ul>
<li class="chapter" data-level="3.1" data-path="machine-setup.html"><a href="machine-setup.html#linux---ubuntu"><i class="fa fa-check"></i><b>3.1</b> Linux - Ubuntu</a></li>
<li class="chapter" data-level="3.2" data-path="machine-setup.html"><a href="machine-setup.html#mac-os"><i class="fa fa-check"></i><b>3.2</b> Mac OS</a></li>
<li class="chapter" data-level="3.3" data-path="machine-setup.html"><a href="machine-setup.html#windows"><i class="fa fa-check"></i><b>3.3</b> Windows</a></li>
<li class="chapter" data-level="3.4" data-path="machine-setup.html"><a href="machine-setup.html#other-connection-options"><i class="fa fa-check"></i><b>3.4</b> Other Connection Options</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="connecting-to-a-database.html"><a href="connecting-to-a-database.html"><i class="fa fa-check"></i><b>4</b> Connecting to a Database</a><ul>
<li class="chapter" data-level="4.1" data-path="connecting-to-a-database.html"><a href="connecting-to-a-database.html#julia"><i class="fa fa-check"></i><b>4.1</b> Julia</a></li>
<li class="chapter" data-level="4.2" data-path="connecting-to-a-database.html"><a href="connecting-to-a-database.html#sas"><i class="fa fa-check"></i><b>4.2</b> SAS</a></li>
<li class="chapter" data-level="4.3" data-path="connecting-to-a-database.html"><a href="connecting-to-a-database.html#r"><i class="fa fa-check"></i><b>4.3</b> R</a></li>
<li class="chapter" data-level="4.4" data-path="connecting-to-a-database.html"><a href="connecting-to-a-database.html#python"><i class="fa fa-check"></i><b>4.4</b> Python</a></li>
<li class="chapter" data-level="4.5" data-path="connecting-to-a-database.html"><a href="connecting-to-a-database.html#jsl"><i class="fa fa-check"></i><b>4.5</b> JSL</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html"><i class="fa fa-check"></i><b>5</b> Writing to a Database</a><ul>
<li class="chapter" data-level="5.1" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#julia-1"><i class="fa fa-check"></i><b>5.1</b> Julia</a><ul>
<li class="chapter" data-level="5.1.1" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#alternative-method-for-big-data"><i class="fa fa-check"></i><b>5.1.1</b> Alternative method for big data</a></li>
<li class="chapter" data-level="5.1.2" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#bulk-insert"><i class="fa fa-check"></i><b>5.1.2</b> Bulk Insert</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#r-1"><i class="fa fa-check"></i><b>5.2</b> R</a><ul>
<li class="chapter" data-level="5.2.1" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#simple-table-iris"><i class="fa fa-check"></i><b>5.2.1</b> Simple Table: Iris</a></li>
<li class="chapter" data-level="5.2.2" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#related-tables-connected-by-keys-bakery-files"><i class="fa fa-check"></i><b>5.2.2</b> Related Tables Connected by Keys: Bakery Files</a></li>
<li class="chapter" data-level="5.2.3" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#alternative-method-for-big-data-1"><i class="fa fa-check"></i><b>5.2.3</b> Alternative method for big data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#python-1"><i class="fa fa-check"></i><b>5.3</b> Python</a><ul>
<li class="chapter" data-level="5.3.1" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#simple-table-iris-1"><i class="fa fa-check"></i><b>5.3.1</b> Simple Table: Iris</a></li>
<li class="chapter" data-level="5.3.2" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#related-tables-connected-by-keys-bakery-files-1"><i class="fa fa-check"></i><b>5.3.2</b> Related Tables Connected by Keys: Bakery Files</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="writing-to-a-database.html"><a href="writing-to-a-database.html#sas-1"><i class="fa fa-check"></i><b>5.4</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="querying-a-database.html"><a href="querying-a-database.html"><i class="fa fa-check"></i><b>6</b> Querying a Database</a><ul>
<li class="chapter" data-level="6.1" data-path="querying-a-database.html"><a href="querying-a-database.html#julia-2"><i class="fa fa-check"></i><b>6.1</b> Julia</a><ul>
<li class="chapter" data-level="6.1.1" data-path="querying-a-database.html"><a href="querying-a-database.html#query-database-to-select-all-rows-then-filterselect-rows-in-julia"><i class="fa fa-check"></i><b>6.1.1</b> Query database to select all rows, then filter/select rows in julia</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="querying-a-database.html"><a href="querying-a-database.html#r-2"><i class="fa fa-check"></i><b>6.2</b> R</a></li>
<li class="chapter" data-level="6.3" data-path="querying-a-database.html"><a href="querying-a-database.html#python-2"><i class="fa fa-check"></i><b>6.3</b> Python</a><ul>
<li class="chapter" data-level="6.3.1" data-path="querying-a-database.html"><a href="querying-a-database.html#standard-python"><i class="fa fa-check"></i><b>6.3.1</b> Standard Python</a></li>
<li class="chapter" data-level="6.3.2" data-path="querying-a-database.html"><a href="querying-a-database.html#pandas"><i class="fa fa-check"></i><b>6.3.2</b> Pandas</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="querying-a-database.html"><a href="querying-a-database.html#sas-2"><i class="fa fa-check"></i><b>6.4</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="web-api.html"><a href="web-api.html"><i class="fa fa-check"></i><b>7</b> Web API</a><ul>
<li class="chapter" data-level="7.1" data-path="web-api.html"><a href="web-api.html#julia-3"><i class="fa fa-check"></i><b>7.1</b> Julia</a></li>
<li class="chapter" data-level="7.2" data-path="web-api.html"><a href="web-api.html#r-3"><i class="fa fa-check"></i><b>7.2</b> R</a></li>
<li class="chapter" data-level="7.3" data-path="web-api.html"><a href="web-api.html#python-3"><i class="fa fa-check"></i><b>7.3</b> Python</a></li>
<li class="chapter" data-level="7.4" data-path="web-api.html"><a href="web-api.html#sas-3"><i class="fa fa-check"></i><b>7.4</b> SAS</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using Databases</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="background" class="section level1">
<h1><span class="header-section-number">2</span> Background</h1>
<div id="motivation" class="section level2">
<h2><span class="header-section-number">2.1</span> Motivation</h2>
<p>With the advent of large and remote data sources comes a need to for proper training in accessing and utilizing databases. The Cal Poly statistics department, at the current time, lacks a formal remote data course. This leaves it up to the discresion of professor to include such material in their courses, and possibly leaves students to learn these essential skills outside of the classroom.</p>
<p>The technical purpose of this book is to demostrate how to <a href="03-connections.Rmd">connect to</a>, <a href="04-writing.Rmd">upload data to</a>, and <a href="05-querying.Rmd">read data from</a> a Microsoft Server database. While the code provided in this book is specific to Microsoft SQL, the lessens can likely be extended to any database, with a few google-able differences.</p>
</div>
<div id="about-databases" class="section level2">
<h2><span class="header-section-number">2.2</span> About Databases</h2>
<p>A database stores data, and is usually controlled by a database management system. Data in most databases is typically modeled in a way similar to what we usually see as statisticians–rows and columns in a series of tables. Most databases utilize structured query language (SQL) to build tables, write data, and query data. Most databases are also stored on a remote server.</p>
<div id="relational-model" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Relational Model</h3>
<div id="relation-and-relationships" class="section level4">
<h4><span class="header-section-number">2.2.1.1</span> Relation and Relationships</h4>
<p>Many databases follow the relational model. In a relational model, each table is a <em>relation</em>. These relations consist of <em>attriutes</em>, or columns, and <em>tuples</em>, or rows. A relationship is a connection between relations (tables).</p>
<p>An example database we’ll use in this book is about a bakery. The <em>relations</em> are customers, items, receipts, and goods. In the receipts relation, the <em>attributes</em> are receipt ID, customer ID, and date of purchase. Each <em>tuple</em> represents one receipt. One <em>relation</em> is that customer ID references the ID attribute of the customers relation.</p>
</div>
<div id="keys" class="section level4">
<h4><span class="header-section-number">2.2.1.2</span> Keys</h4>
<p>A <em>primary key</em> is an attribute or set of attributes that uniquely identifies a tuple. For example, the primary key in the receipts relation is the receipt ID, unique to each row. A <em>foreign key</em> is an attribute or set of attributes that references the primary key of another relation. For instance, within the receipts relation, the customer ID attribute references the primary key of the customers relation.</p>
</div>
</div>
<div id="basic-introduction-to-sql" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Basic Introduction to SQL</h3>
<p>Structured query language, more commonly known as SQL, is used to build tables, write data, and query data. SQL includes data definition language (DDL), data manipulation language (DML), data control language (DCL), and query language (QL).</p>
<ul>
<li>DDL: Data definition language is used to define and manipulate relational schemas. This means defining the table’s attributes and keys. DDL includes statements like <code>create table</code> and <code>alter table</code> that you’ll see later in this book, espcially in <a href="04-writing.Rmd">the section on writing to a database</a>.</li>
<li>DML: Data manipulation language is used to add, update, and delete data from tables. This includes statements like <code>insert</code>, which you will see later in this book, as well as <code>update</code> and <code>delete</code>, espcially in <a href="04-writing.Rmd">the section on writing to a database</a>.</li>
<li>DCL: Data control language is used to implement security and access rules. This is something a professor who created the database can use to decide which students can see what data. We wont discuss any DCL in this book.</li>
<li>QL: Query language is used to request information from the database. The most used command in QL is <code>select</code>. You will see a lot of this in this book, espically in <a href="05-querying.Rmd">the section on querying a database</a>.</li>
</ul>
<div id="more-details-on-query-language" class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> More details on query language</h4>
<p>To explore some common SQL queries, we’ll look at the iris dataset. Recall that its attributes are sepal length, sepal width, petal length, petal width, and species.</p>
<p>The most basic SQL query is <code>select * from iris</code>. This will return the full table.</p>
<div id="order-by-and-top" class="section level5">
<h5><span class="header-section-number">2.2.2.1.1</span> Order by and Top</h5>
<p>Order by is used to sort a relation by an attribute. Limit can be used to take the first <code>n</code> tuples from a relation. For example, the statement below returns data for the five flowers with the highest sepal length.</p>
<pre><code>select top 5 SepalLength, Species from iris 
  order by SepalLength;</code></pre>
<pre><code>  SepalLength Species
1         4.3  setosa
2         4.4  setosa
3         4.4  setosa
4         4.4  setosa
5         4.5  setosa</code></pre>
</div>
<div id="where" class="section level5">
<h5><span class="header-section-number">2.2.2.1.2</span> Where</h5>
<p>The returned table can be subsetted to the desired data with a <code>where</code> clause. For instance, if we only wanted to look at the subset of iris where the species is sesota and the petals are over 1 centimeter long, we could use the following select statement:</p>
<pre><code>select * from iris
  where Species = &#39;setosa&#39; and
        Petal.Length &gt; 1;</code></pre>
<pre><code>   SepalLength SepalWidth PetalLength PetalWidth Species
1          5.1        3.5         1.4        0.2  setosa
2          4.9        3.0         1.4        0.2  setosa
...</code></pre>
<p>We can also select only specific columns. The following statement will return only the petal measurements and species.</p>
<pre><code>select PetalLength, PetalWidth, Species from iris
  where Species = &#39;setosa&#39; and
        PetalLength &gt; 1;</code></pre>
<pre><code>   PetalLength PetalWidth Species
1          1.4        0.2  setosa
2          1.4        0.2  setosa
...</code></pre>
<p>Note that SQL uses a single equal sign for a statement of equality and strings have single quotes.</p>
</div>
<div id="summary-statistics" class="section level5">
<h5><span class="header-section-number">2.2.2.1.3</span> Summary Statistics</h5>
<p>Summary statistics can be obtained by using summary functions in when defining what variables to return. For example, if we want to view the average and maximum petal length, we can use the <code>avg</code> and <code>max</code> summary functions. We can also give these attributes new names with an <code>as</code> clause.</p>
<pre><code>select avg(PetalLength) as average_petal_length, max(PetalLength) as max_petal_length from iris;</code></pre>
<pre><code>  average_petal_length max_petal_length
1                3.758              6.9</code></pre>
</div>
<div id="group-by-having" class="section level5">
<h5><span class="header-section-number">2.2.2.1.4</span> Group By / Having</h5>
<p><code>group by</code> allows us to split, apply, and combine in SQL. For instance, if we wanted the average petal length of flowers, separated by species, we could 1) split: group by species, 2) apply: take the average of petal length, and 3) combine: return a single table with this information.</p>
<pre><code>select Species, avg(PetalLength) as average_petal_length from iris
  group by Species;</code></pre>
<pre><code>     Species average_petal_length
1     setosa                1.462
2 versicolor                4.260
3  virginica                5.552</code></pre>
<p><code>having</code> allows us to place where-like conditions related to the grouping variable. For instance, if we only wanted to display the species and average petal length for irises with over 10 observations, we could use having. (In this case, all species have 50 observations, so all averages are still reported).</p>
<pre><code>select Species, avg(PetalLength) as average_petal_length from iris
  group by Species
  having count(*) &gt; 10;</code></pre>
<pre><code>     Species average_petal_length
1     setosa                1.462
2 versicolor                4.260
3  virginica                5.552</code></pre>
<p>Note that conditions unrelated to the grouping variable can still be present in a where clause, which would go before the group by statement. Suppose, for instance, we wanted the average petal length of flowers with sepal lengths over 6 centimeters, by species, for species with over 10 observations with sepal lengths over 6 centimeters. (Note that setosa flowers don’t have enough long-sepaled observations to be included in this output).</p>
<pre><code>select Species, avg(PetalLength) as average_petal_length from iris
  where Sepal.Length &gt; 6
  group by Species
  having count(*) &gt; 10;</code></pre>
<pre><code>     Species average_petal_length
1 versicolor             4.585000
2  virginica             5.682927</code></pre>
</div>
<div id="case" class="section level5">
<h5><span class="header-section-number">2.2.2.1.5</span> Case</h5>
<p>Case can be used to create new attributes based on some condition. The statement below creates a new attribute, long_sepal, is set to true when the sepa is over 6 centimeters long, and false otherwise.</p>
<pre><code>select SepalLength, (
  case when SepalLength &gt; 6 then &#39;true&#39; 
  else &#39;false&#39; 
  end) as long_sepal from iris;</code></pre>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="machine-setup.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
